syntax = "proto3";

// Import student.proto
import "studentpb/student.proto";

// Proto Package
package exam;

// Go package
option go_package = "github.com/ChrisCodeX/gRPC/exampb";

// Exam model
message Exam {
    string id = 1;
    string name = 2;
}

// Question model
message Question {
    string id = 1;
    string question = 2;
    string exam_id = 3;
}

// Unary
/* Clients request messages */
// Get a exam
message GetExamRequest {
    string id = 1;
}

/* Server response message */
message SetExamResponse {
    string id = 1;
}

// Stream

/* Enroll student to exam */
// Enroll request from client
message EnrollmentRequest {
    string fk_student_id = 1;
    string fk_exam_id = 2;
}

// End stream response for enrollment from server
message EnrollmentResponse {
    bool ok = 1;
}

// Every request response
message GetStudentsPerExamRequest {
    string fk_exam_id = 1;
}

/* Questions */
// End stream response for question
message SetQuestionResponse {
    bool ok = 1;
}

// 
message TakeExamRequest {
    string answer = 1;
}

// Exam service
service ExamService {
    /* Methods Unary */
    // Client request
    rpc GetExam(GetExamRequest) returns (Exam);
    // Server response
    rpc SetExam(Exam) returns (SetExamResponse);

    /* Stream */
    
    // Stream from client - 1 response from server
    rpc EnrollStudents(stream EnrollmentRequest) returns (EnrollmentResponse);

    // Stream for server - 1 response from client
    rpc GetStudentsPerExam(GetStudentsPerExamRequest) returns (stream student.Student);

    // Stream from client - 1 response from server
    rpc SetQuestions(stream Question) returns (SetQuestionResponse);


    // Stream Bidirectional
    rpc TakeExam(stream TakeExamRequest) returns (stream Question);
}


